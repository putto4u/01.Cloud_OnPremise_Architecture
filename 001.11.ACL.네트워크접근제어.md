 **ACL(Access Control List)**은 네트워크 **보안**과 **트래픽 제어**를 위한 가장 기본적인 기술이며, 라우터나 스위치, 방화벽에서 필수적으로 사용됩니다. 

---

##  ACL(Access Control List)을 이용한 네트워크 접근 제어

ACL은 장비(주로 라우터와 방화벽)를 통과하는 패킷의 헤더(주로 출발IP와 Port) 정보를 검사하여, 미리 정의된 **규칙(Rule)**에 따라 해당 패킷을 **허용(Permit)**할지 **차단(Deny)**할지를 결정하는 목록입니다.

### 1. ACL의 기본 작동 원리

ACL은 패킷의 L3(IP 주소) 및 L4(포트 번호) 정보를 기준으로 동작하는 것이 일반적입니다.

1.  **패킷 검사:** 라우터 인터페이스에 ACL이 적용되면, 해당 인터페이스로 들어오거나 나가는 **모든 패킷**이 목록의 규칙을 순서대로 검사받습니다.
2.  **순차적 일치:** 패킷은 목록의 **첫 번째 규칙부터 순서대로** 대조됩니다.
3.  **첫 번째 일치 시 결정:** 패킷이 목록의 **어떤 규칙과 일치**하는 순간, 그 규칙에 정의된 동작(허용 또는 차단)을 수행하고 **더 이상 다음 규칙을 검사하지 않습니다.**
4.  **암묵적 거부 (Implicit Deny):** 모든 ACL의 맨 마지막에는 **"일치하는 규칙이 없으면 모든 트래픽을 거부한다"**는 암묵적 규칙($\text{deny any any}$)이 숨겨져 있습니다. 따라서 ACL을 생성할 때는 **최소한 하나 이상의 허용(Permit) 규칙**이 있어야 합니다.

---

### 2. ACL의 종류와 적용 위치

ACL은 검사하는 기준과 적용 위치에 따라 크게 두 가지로 분류됩니다.

#### 2.1. 표준 ACL (Standard ACL)

| 특징 | 설명 | 실전 적용 팁 |
| :--- | :--- | :--- |
| **검사 기준** | 오직 패킷의 **출발지 IP 주소**만 검사합니다 (L3). | 목적지나 포트 번호를 지정할 수 없으므로, **차단(Deny)** 규칙은 **목적지 라우터에 최대한 가깝게** 적용하는 것이 좋습니다. |
| **ACL 번호** | `1`부터 `99` (확장 범위도 존재) | |

#### 2.2. 확장 ACL (Extended ACL)

| 특징 | 설명 | 실전 적용 팁 |
| :--- | :--- | :--- |
| **검사 기준** | **출발지 IP, 목적지 IP** (L3), **프로토콜(TCP/UDP)**, **포트 번호** (L4) 등을 종합적으로 검사합니다. | 세밀한 제어가 가능하므로, **출발지 라우터에 최대한 가깝게** 적용하여 불필요한 트래픽이 네트워크에 진입하는 것을 초기에 차단해야 합니다. |
| **ACL 번호** | `100`부터 `199` (확장 범위도 존재) | |

#### 2.3. 적용 방향 (Inbound vs. Outbound)

* **Inbound (In):** 라우터의 인터페이스로 **들어오는** 패킷에 적용하여, 네트워크 내부로 진입하는 트래픽을 통제합니다.
* **Outbound (Out):** 라우터의 인터페이스에서 **나가는** 패킷에 적용하여, 네트워크 외부로 나가는 트래픽을 통제합니다.

---

### 3. ACL을 이용한 보안 구축 예시 (실전 팁)

ACL은 특히 **DB 서버 보안**과 같은 중요한 영역에서 필수적입니다.

#### 예시: DB 서버 접근 제어

**목표:** 특정 서버(App Server, IP: `192.168.10.10`)만 DB 서버(DB Server, IP: `192.168.20.20`)의 **MySQL 포트(3306)**에 접근하도록 허용하고, 다른 모든 접근은 차단합니다.

| 순서 | 규칙 (확장 ACL 사용) | 의미 |
| :---: | :--- | :--- |
| **1.** | `permit tcp host 192.168.10.10 host 192.168.20.20 eq 3306` | App Server(`10.10`)에서 DB Server(`20.20`)로의 3306(TCP) 접근을 **명시적으로 허용**합니다. |
| **2.** | `deny ip any any` | 나머지 **모든 출발지**에서 DB Server로의 **모든 프로토콜** 접근을 **차단**합니다. (암묵적 거부가 있지만, 명시하는 것이 좋습니다.) |

**적용 위치:** 이 ACL은 DB 서버 네트워크로 향하는 라우터의 인터페이스에 **Inbound** 방향으로 적용되어야 합니다.

> **자주 오해하거나 실수하는 부분:**
>
> 1.  **순서 오류:** ACL은 순서대로 검사하므로, 포괄적인 **`deny` 규칙을 `permit` 규칙보다 먼저** 두면 원하는 서비스가 모두 차단됩니다.
> 2.  **암묵적 거부:** `permit` 규칙만 달랑 만들면, 나머지 모든 트래픽이 차단되어 필요한 서비스(DNS, 웹 등)까지 막힐 수 있습니다. 필요한 다른 트래픽에 대한 `permit` 규칙도 명시해야 합니다.
> 3.  **반환 트래픽:** TCP 통신을 허용하려면 일반적으로 **발신(Outbound) 트래픽**뿐만 아니라, **수신(Inbound) 트래픽**에 대한 반환 세션도 허용해야 합니다 (방화벽의 상태 추적 기능이 ACL보다 편리한 이유입니다). 


---
## 제 2장: 전용 보안 장비와 ACL의 검사 범위

ACL은 범용 라우터나 스위치에서도 수행할 수 있는 기능이지만, 네트워크 규모가 커지고 보안 위협이 정교해짐에 따라 이를 전문적으로 처리하는 전용 장비와 기술이 존재한다.

---

### 1. ACL 전용 장비의 존재 여부

엄밀히 말해 'ACL만을 위한 단일 장비'보다는 ACL의 기능을 포함하면서도 훨씬 강력한 분석 능력을 갖춘 **전용 보안 장비**들이 그 역할을 대신한다.

* **차세대 방화벽 (NGFW):** 전통적인 ACL은 IP와 포트만 보지만, 방화벽은 세션의 상태를 기억(Stateful Inspection)하며 ACL 규칙을 적용한다.
* **IDS/IPS (침입 탐지/차단 시스템):** 단순한 허용/거부를 넘어, 패킷 내부의 패턴을 분석하여 공격 여부를 판단한다.
* **UTM (Unified Threat Management):** 방화벽, IPS, 백신, ACL 기능을 하나의 장비에 통합한 솔루션이다.

---

### 2. ACL과 전용 보안 장비의 검사 범위 비교

ACL이 검사할 수 있는 범위는 장비의 지능과 처리 계층(Layer)에 따라 달라진다.

| 구분 | 검사 범위 (OSI 모델) | 주요 검사 항목 | 비고 |
| --- | --- | --- | --- |
| **Standard ACL** | Layer 3 | 출발지 IP 주소 | 가장 빠르지만 단순함 |
| **Extended ACL** | Layer 3 & 4 | 출발지/목적지 IP, 프로토콜, 포트 번호 | 특정 서비스(HTTP, FTP 등) 제어 |
| **DPI (전용 장비)** | Layer 7 (Application) | **패킷 페이로드(데이터 내용)**, URL, 앱 종류 | 실제 데이터 내용까지 심층 분석 |

---

### 3. 심층 패킷 분석 (DPI: Deep Packet Inspection)

전문적인 보안 장비는 **DPI** 기술을 사용하여 ACL보다 훨씬 깊은 곳까지 검사한다.

* **헤더를 넘어서는 검사:** ACL이 편지의 '봉투(주소)'만 확인한다면, DPI를 사용하는 전용 장비는 '편지 내용(데이터)'을 직접 읽어 위험한 단어나 악성 코드가 있는지 확인한다.
* **애플리케이션 식별:** 같은 80번 포트(HTTP) 트래픽이라도 이것이 일반적인 웹 서핑인지, 아니면 P2P 파일 공유인지 구분하여 차단할 수 있다.
* **사용자 기반 제어:** IP 주소가 아닌, 실제 로그인한 사용자 ID를 기반으로 접근 권한을 부여한다.

---

### 4. 실무적 배치 전략

성능 최적화를 위해 모든 검사를 하나의 장비에 맡기지 않고 계층적으로 배치한다.

1. **외곽 라우터 (L3 ACL):** 명백히 차단해야 할 대규모 IP 대역이나 불필요한 프로토콜을 1차적으로 빠르게 걸러낸다. (CPU 부하 최소화)
2. **전용 방화벽/IPS (L7 DPI):** 1차 필터링을 통과한 트래픽에 대해 상세한 데이터 분석과 세션 관리를 수행한다.
3. **내부 스위치 (VLAN ACL):** 부서 간의 접근 통제 등 내부 보안을 강화한다.

---

### 5. 요약: 검사 범위의 한계

* **ACL의 한계:** 데이터 내용(Payload)에 숨겨진 악성코드는 찾아낼 수 없으며, 암호화된 트래픽 내부를 들여다보는 데 한계가 있다.
* **전용 장비의 강점:** 데이터의 흐름과 맥락을 파악하고, 실시간 업데이트되는 보안 위협 DB를 바탕으로 지능형 공격을 방어한다.

---

**Next: NAT(Network Address Translation)의 유형과 동작 원리**

DPI(심층 패킷 분석), 차세대 방화벽, L7 보안, 상태 중심 검사(Stateful Inspection)
---
## ACL(Access Control List)의 구성 형식과 문법

ACL은 필터링의 정교함에 따라 **Standard(표준)**와 **Extended(확장)** 형식으로 나뉘며, 작성 방식에 따라 **Numbered(번호 기반)**와 **Named(이름 기반)** 형식으로 구분됩니다. 각 형식의 기술적 구조는 다음과 같습니다.

---

### 1. Standard ACL 형식 (번호 기반)

출발지 IP 주소만을 조건으로 사용하며, 가장 단순한 구조를 가집니다.

* **번호 범위:** 1~99, 1300~1999
* **기본 문법:**
`access-list [번호] [permit | deny] [출발지 IP] [와일드카드 마스크]`

> **예시:** `access-list 10 deny 192.168.1.0 0.0.0.255`
> (해석: 192.168.1.0/24 대역에서 오는 모든 패킷을 거부함)

---

### 2. Extended ACL 형식 (번호 기반)

출발지/목적지 IP, 프로토콜, 포트 번호를 조합하여 정교하게 필터링합니다.

* **번호 범위:** 100~199, 2000~2699
* **기본 문법:**
`access-list [번호] [permit | deny] [프로토콜] [출발지 IP] [와일드카드] [목적지 IP] [와일드카드] [연산자] [포트번호]`
* **프로토콜:** ip, tcp, udp, icmp 등
* **연산자:** eq(equal), neq(not equal), gt(greater than), lt(less than), range

> **예시:** `access-list 110 permit tcp any host 10.1.1.100 eq 80`
> (해석: 어디서든 10.1.1.100 서버의 80번(HTTP) 포트로 들어오는 TCP 트래픽을 허용함)

---

### 3. Named ACL 형식 (이름 기반)

번호 대신 직관적인 이름을 사용하여 가독성을 높이고, 특정 행만 수정하기 용이한 현대적인 방식입니다.

* **작성 방법:**
1. `ip access-list [standard | extended] [이름]` 명령으로 설정 모드 진입
2. 설정 모드 내부에서 `permit` 또는 `deny` 조건 입력



> **예시:**
> ```bash
> Router(config)# ip access-list extended SECURE_WEB
> Router(config-ext-nacl)# permit tcp 192.168.10.0 0.0.0.255 any eq 443
> Router(config-ext-nacl)# deny ip any any
> 
> ```
> 
> 

---

### 4. ACL의 주요 키워드 형식

ACL을 더 간결하게 작성하기 위해 다음과 같은 키워드를 지원합니다.

* **host:** 특정 단일 IP를 지정할 때 사용 (와일드카드 `0.0.0.0` 대용)
* `host 192.168.1.1` = `192.168.1.1 0.0.0.0`


* **any:** 모든 IP 주소를 지정할 때 사용 (와일드카드 `255.255.255.255` 대용)
* `any` = `0.0.0.0 255.255.255.255`



---

### 5. 인터페이스 적용 형식 (필수 단계)

ACL을 생성한 후에는 반드시 특정 인터페이스에 방향(In/Out)을 지정하여 적용해야 합니다.

* **문법:** `ip access-group [번호 | 이름] [in | out]`

> **예시:**
> ```bash
> Router(config)# interface gigabitEthernet 0/0
> Router(config-if)# ip access-group SECURE_WEB in
> 
> ```
> 
> 

---

**Next: 와일드카드 마스크(Wildcard Mask) 계산 및 적용 방법**

Standard ACL, Extended ACL, Named ACL, host/any 키워드, ip access-group
---
## ACL 실전 케이스 스터디 및 CLI 설정 가이드

네트워크 환경에서 발생할 수 있는 다양한 보안 요구사항을 ACL(Access Control List)로 해결하는 능력을 기르기 위한 실습 사례이다. 각 케이스별 문제 정의, 유형 설명, 그리고 실제 Cisco 장비에서 사용되는 CLI(Command Line Interface) 모범 답안을 통합하여 기술한다.

---


### [CASE 01] 특정 호스트의 외부 접속 차단

* **문제:** 내부망의 특정 PC(192.168.10.5)가 외부 인터넷으로 나가는 모든 트래픽을 차단하고, 나머지 사용자는 허용하시오.
* **케이스 유형:** **Standard ACL - Host Filtering**
* 출발지 IP만 확인하면 되므로 Standard ACL을 사용하며, 목적지와 가장 가까운 라우터 인터페이스의 Outbound에 적용한다.


* **CLI 모범 답안:**
```bash
Router(config)# access-list 1 deny host 192.168.10.5
Router(config)# access-list 1 permit any
Router(config)# interface gigabitEthernet 0/1  # 외부망 연결 인터페이스
Router(config-if)# ip access-group 1 out

```



### [CASE 02] 웹 서버 전용 서비스 포트 제한

* **문제:** 외부에서 사내 웹 서버(10.10.10.100)로 오직 HTTP(80)와 HTTPS(443) 접속만 허용하고 나머지는 거부하시오.
* **케이스 유형:** **Extended ACL - Multi-Port Service Control**
* 동일한 목적지 IP에 대해 여러 포트 번호를 제어해야 하므로 Extended ACL을 사용한다.


* **CLI 모범 답안:**
```bash
Router(config)# ip access-list extended WEB_ONLY
Router(config-ext-nacl)# permit tcp any host 10.10.10.100 eq 80
Router(config-ext-nacl)# permit tcp any host 10.10.10.100 eq 443
Router(config-ext-nacl)# exit
Router(config)# interface gigabitEthernet 0/0  # 외부 유입 인터페이스
Router(config-if)# ip access-group WEB_ONLY in

```



### [CASE 03] 부서(서브넷) 간 통신 격리

* **문제:** 엔지니어링 부서(192.168.20.0/24)와 인사팀 부서(192.168.30.0/24) 사이의 모든 통신을 차단하시오.
* **케이스 유형:** **Extended ACL - Subnet to Subnet Filtering**
* 특정 네트워크 대역 간의 분리를 목적으로 하며, 와일드카드 마스크 `0.0.0.255`를 사용하여 대역 전체를 지정한다.


* **CLI 모범 답안:**
```bash
Router(config)# access-list 105 deny ip 192.168.20.0 0.0.0.255 192.168.30.0 0.0.0.255
Router(config)# access-list 105 permit ip any any
Router(config)# interface gigabitEthernet 0/0
Router(config-if)# ip access-group 105 in

```



### [CASE 04] 관리자 전용 원격 접속(Telnet) 설정

* **문제:** 라우터(172.16.1.1)의 원격 관리(Telnet)는 오직 관리자 PC(172.16.1.50)에서만 가능하도록 제한하시오.
* **케이스 유형:** **VTY(Virtual Type Terminal) ACL**
* 인터페이스가 아닌 가상 터미널 라인에 `access-class` 명령어로 적용하여 장비 자체 보안을 강화한다.


* **CLI 모범 답안:**
```bash
Router(config)# access-list 20 permit host 172.16.1.50
Router(config)# line vty 0 4
Router(config-line)# access-class 20 in
Router(config-line)# password cisco_admin
Router(config-line)# login

```



### [CASE 05] 특정 프로토콜 대역(UDP) 필터링

* **문제:** 특정 서버 대역에서 발생하는 불필요한 UDP 스트리밍 트래픽(포트 5000-6000)을 차단하시오.
* **케이스 유형:** **Extended ACL - Protocol-Specific Filtering**
* TCP뿐만 아니라 UDP 프로토콜과 포트 범위를 명시하여 정교하게 제어한다.


* **CLI 모범 답안:**
```bash
Router(config)# access-list 120 deny udp any any range 5000 6000
Router(config)# access-list 120 permit ip any any
Router(config)# interface gigabitEthernet 0/1
Router(config-if)# ip access-group 120 out

```



### [CASE 06] 사내망 ICMP(Ping) 발신 제한

* **문제:** 내부 사용자가 외부로 Ping을 보내는 것을 금지하되, 일반적인 데이터 통신은 허용하시오.
* **케이스 유형:** **Extended ACL - ICMP Filtering**
* IP 패킷의 하위 프로토콜인 ICMP 중 `echo` 메시지 타입을 선별적으로 차단한다.


* **CLI 모범 답안:**
```bash
Router(config)# access-list 115 deny icmp 192.168.10.0 0.0.0.255 any echo
Router(config)# access-list 115 permit ip any any
Router(config)# interface gigabitEthernet 0/0
Router(config-if)# ip access-group 115 in

```



### [CASE 07] 서버 점검을 위한 조건부 차단

* **문제:** 서버(10.1.1.10) 점검 중 모든 접근을 차단하되, 관리 로그 서버(10.1.1.254)와의 통신은 유지하시오.
* **케이스 유형:** **ACL Sequence Management**
* ACL의 순차적 처리 특성을 이용하며, Named ACL을 통해 시퀀스 번호를 관리한다.


* **CLI 모범 답안:**
```bash
Router(config)# ip access-list extended SERVER_MAINTENANCE
Router(config-ext-nacl)# 10 permit ip host 10.1.1.254 host 10.1.1.10
Router(config-ext-nacl)# 20 deny ip any host 10.1.1.10
Router(config-ext-nacl)# 30 permit ip any any
Router(config)# interface gigabitEthernet 0/1
Router(config-if)# ip access-group SERVER_MAINTENANCE out

```



### [CASE 08] 특정 서버의 FTP 서비스만 차단

* **문제:** 파일 서버(172.30.1.50)에 대한 일반 접속은 허용하되, FTP 데이터 및 제어 포트만 차단하시오.
* **케이스 유형:** **Extended ACL - Application Port Filtering**
* 특정 애플리케이션 서비스(Port 20, 21)만 선별적으로 차단하는 실무 사례이다.


* **CLI 모범 답안:**
```bash
Router(config)# access-list 150 deny tcp any host 172.30.1.50 eq 20
Router(config)# access-list 150 deny tcp any host 172.30.1.50 eq 21
Router(config)# access-list 150 permit ip any any
Router(config)# interface gigabitEthernet 0/0
Router(config-if)# ip access-group 150 in

```



### [CASE 09] 대규모 유동 IP 대역의 DB 접근 허용

* **문제:** 지점 대역(10.200.0.0/16)에서 본사 DB 서버(10.100.1.10)의 특정 포트(1521) 접근을 허용하시오.
* **케이스 유형:** **Extended ACL - Large Range Masking**
* 넓은 대역의 와일드카드 마스크(`0.0.255.255`)를 활용하여 다수의 IP를 효율적으로 관리한다.


* **CLI 모범 답안:**
```bash
Router(config)# access-list 160 permit tcp 10.200.0.0 0.0.255.255 host 10.100.1.10 eq 1521
Router(config)# interface gigabitEthernet 0/0
Router(config-if)# ip access-group 160 in

```



### [CASE 10] 보안 강화를 위한 특정 유해 포트 차단

* **문제:** 기본적으로 모든 통신을 허용하되, 취약점 공격에 사용되는 특정 포트(TCP 445)만 전사적으로 차단하시오.
* **케이스 유형:** **Security Hardening - Known Bad Port Blocking**
* 차단할 포트를 최상단에 두고, 마지막에 `permit ip any any`를 명시하여 기본 정책을 '허용'으로 설정한다.


* **CLI 모범 답안:**
```bash
Router(config)# access-list 199 deny tcp any any eq 445
Router(config)# access-list 199 permit ip any any
Router(config)# interface gigabitEthernet 0/1
Router(config-if)# ip access-group 199 out

```



---

**Next: NAT(Network Address Translation)의 유형과 동작 원리**

CLI 설정, Standard ACL, Extended ACL, VTY 보안, 와일드카드 마스크
